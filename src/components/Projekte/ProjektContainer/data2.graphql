query TreeDataQuery(
  $projId: UUID!
  $isProjekt: Boolean!
  $apId: UUID
  $isAp: Boolean!
  $apIsActiveInMap: Boolean!
) {
  popForMapMarkers: projektById(id: $projId) @include(if: $apIsActiveInMap) {
    id
    apsByProjId(filter: { id: { equalTo: $apId } }) {
      nodes {
        id
        popsByApId(filter: { x: { isNull: false }, y: { isNull: false } }) {
          nodes {
            id
            apId
            nr
            name
            status
            statusUnklar
            statusUnklarBegruendung
            bekanntSeit
            x
            y
          }
        }
      }
    }
  }
  beobAssignLines: projektById(id: $projId) @include(if: $isProjekt) {
    id
    apsByProjId(filter: { id: { equalTo: $apId } }) @include(if: $isAp) {
      nodes {
        id
        apartsByApId {
          nodes {
            id
            artId
            aeEigenschaftenByArtId {
              id
              beobsByArtId(
                filter: {
                  tpopId: { isNull: false }
                  nichtZuordnen: { equalTo: false }
                  x: { isNull: false }
                  y: { isNull: false }
                }
              ) {
                nodes {
                  id
                  autor
                  datum
                  beobQuelleWerteByQuelleId {
                    id
                    name
                  }
                  x
                  y
                  aeEigenschaftenByArtId {
                    id
                    artname
                  }
                  tpopByTpopId {
                    id
                    popId
                    nr
                    flurname
                    x
                    y
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
